{"version":3,"sources":["webpack:///webpack/bootstrap 2f762a186efd8a4c9df4","webpack:///./src/server.js","webpack:///external \"hapi\"","webpack:///external \"hapi-auth-jwt\"","webpack:///./src/routes/vote/vote.get.js","webpack:///./src/shared/route.js","webpack:///./src/routes/vote/vote.service.js","webpack:///external \"q\"","webpack:///./src/shared/redis-db.js","webpack:///external \"redis\"","webpack:///external \"url\"","webpack:///./src/routes/vote/vote.list.js","webpack:///./src/routes/vote/vote.post.js","webpack:///./src/routes/auth/auth.post.js","webpack:///./src/routes/auth/auth.service.js","webpack:///external \"qs\"","webpack:///external \"jwt-simple\"","webpack:///external \"moment\"","webpack:///external \"request\"","webpack:///./src/config.js"],"names":[],"mappings":"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","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 2f762a186efd8a4c9df4\n **/","import Hapi from 'hapi';\nimport hapiAuthJwt from 'hapi-auth-jwt';\nimport VoteGetRoute from './routes/vote/vote.get.js';\nimport VoteListRoute from './routes/vote/vote.list.js';\nimport VotePostRoute from './routes/vote/vote.post.js';\nimport AuthPostRoute from './routes/auth/auth.post';\nimport AuthService from './routes/auth/auth.service';\n\nconst authService = new AuthService();\nconst server = new Hapi.Server();\nserver.connection({\n    host: process.env.IP || '0.0.0.0',\n    port: process.env.PORT || 3000\n});\n\nserver.register(hapiAuthJwt, () => {\n    server.auth.strategy('token', 'jwt', authService.authStrategy);\n\n    server.route({\n        method: 'GET',\n        path: '/api/test',\n        handler(request, reply) {\n            reply({ test: 'test' });\n        }\n    });\n\n    server.route(new VoteGetRoute());\n    server.route(new VoteListRoute());\n    server.route(new VotePostRoute());\n    server.route(new AuthPostRoute());\n});\n\nserver.start((err) => {\n    if (err) { throw err; }\n    console.log(`Server running at: ${server.info.uri}`);\n});\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server.js\n **/","module.exports = require(\"hapi\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"hapi\"\n ** module id = 1\n ** module chunks = 0\n **/","module.exports = require(\"hapi-auth-jwt\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"hapi-auth-jwt\"\n ** module id = 2\n ** module chunks = 0\n **/","import Route from '../../shared/route';\nimport VoteService from './vote.service';\n\nclass VoteGetRoute extends Route {\n\n    constructor(method = 'GET', path = '/api/vote') {\n        super({ method, path });\n        this.config = {\n            cors: true,\n            auth: 'token'\n        };\n    }\n\n    handler(request, reply) {\n        const voteService = new VoteService();\n        const credentials = request.auth.credentials;\n        voteService.getVote(credentials).then((vote) => {\n            reply({ vote });\n        });\n    }\n}\n\nexport default VoteGetRoute;\n\n\n/** WEBPACK FOOTER **\n ** ./src/routes/vote/vote.get.js\n **/","class Route {\n\n    constructor(params = {}) {\n        this.method = params.method;\n        this.path = params.path;\n    }\n\n    handler(request, reply) {\n        reply('Hello!');\n    }\n}\n\nexport default Route;\n\n\n/** WEBPACK FOOTER **\n ** ./src/shared/route.js\n **/","import q from 'q';\nimport { saveHash, getHash, addMemberToSet, removeMemberFromSet, getIntersectionOfSets, getSetMembersCount } from '../../shared/redis-db';\n\nconst VOTE_SETS_IDS = ['vote:1', 'vote:2'];\n\nclass VoteService {\n\n    saveVote(user, vote) {\n        // vote id = 1 comes in\n        // we add it user A to vote:1\n        // we get the intersection of vote:1|vote:2\n        // if intersection includes user A\n        // we remove user A from vote:2\n        return addMemberToSet(voteHashKey(vote.id), user.id)\n            .then(() => getIntersectionOfSets(VOTE_SETS_IDS))\n            .then((intersection) => {\n                if (intersection.indexOf(user.id) > -1) {\n                    const keySetToRemove = VOTE_SETS_IDS.filter(v => v !== voteHashKey(vote.id))[0];\n\n                    return removeMemberFromSet(keySetToRemove, user.id);\n                }\n                return q.when(vote);\n            })\n            .then(() => saveHash(voteHashKey(user.id), vote).then(() => vote, (err) => err));\n    }\n\n    getVote(user) {\n        return getHash(voteHashKey(user.id)).then((vote) => vote);\n    }\n\n    listVotes() {\n        const voteCountPromises = VOTE_SETS_IDS.map(key => getSetMembersCount(key));\n\n        return q.all(voteCountPromises)\n            .then((result) =>\n                VOTE_SETS_IDS.map((k, i) => ({\n                    id: i + 1,\n                    count: result[i]\n                }))\n            );\n    }\n}\n\nfunction voteHashKey(id) {\n    return `vote:${id}`;\n}\n\nexport default VoteService;\n\n\n/** WEBPACK FOOTER **\n ** ./src/routes/vote/vote.service.js\n **/","module.exports = require(\"q\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"q\"\n ** module id = 6\n ** module chunks = 0\n **/","import redis from 'redis';\nimport q from 'q';\nimport url from 'url';\n\nconst redisClient = createRedisClient();\nredisClient.on('error', (err) => console.log(`Error ${err}`));\n\nexport function saveHash(key, hash) {\n    const deferred = q.defer();\n\n    redisClient.hmset(key, hash, (err, result) => {\n        if (err) {\n            deferred.reject(`Error saving hash to Redis: ${err}`);\n        }\n\n        deferred.resolve(result);\n    });\n\n    return deferred.promise;\n}\n\nexport function getHash(key) {\n    const deferred = q.defer();\n\n    redisClient.hgetall(key, (err, result) => {\n        if (err) {\n            deferred.reject(`Error retrieving hash ${key} from Redis: ${err}`);\n        }\n\n        deferred.resolve(result);\n    });\n\n    return deferred.promise;\n}\n\nexport function addMemberToSet(key, member) {\n    const deferred = q.defer();\n\n    redisClient.sadd(key, member, (err, result) => {\n        if (err) {\n            deferred.reject(`Error saving set ${key} from Redis: ${err}`);\n        }\n\n        deferred.resolve(result);\n    });\n\n    return deferred.promise;\n}\n\nexport function getSetMembersCount(key) {\n    const deferred = q.defer();\n\n    redisClient.scard(key, (err, result) => {\n        if (err) {\n            deferred.reject(`Error retrieving set ${key} from Redis: ${err}`);\n        }\n\n        deferred.resolve(result);\n    });\n\n    return deferred.promise;\n}\n\nexport function getIntersectionOfSets(keys) {\n    const deferred = q.defer();\n\n    redisClient.sinter(...keys, (err, result) => {\n        if (err) {\n            deferred.reject(`Error retrieving intersection from redis: ${err}`);\n        }\n\n        deferred.resolve(result);\n    });\n\n    return deferred.promise;\n}\n\nexport function removeMemberFromSet(key, member) {\n    const deferred = q.defer();\n\n    redisClient.srem(key, member, (err, result) => {\n        if (err) {\n            deferred.reject(`Error removing ${member} from set ${key} Redis: ${err}`);\n        }\n\n        deferred.resolve(result);\n    });\n\n    return deferred.promise;\n}\n\nfunction createRedisClient() {\n    let client = null;\n    if (process.env.REDISTOGO_URL) {\n        const rtg = url.parse(process.env.REDISTOGO_URL);\n        client = redis.createClient(rtg.port, rtg.hostname);\n        client.auth(rtg.auth.split(':')[1]);\n    } else {\n        client = redis.createClient();\n    }\n    return client;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/shared/redis-db.js\n **/","module.exports = require(\"redis\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"redis\"\n ** module id = 8\n ** module chunks = 0\n **/","module.exports = require(\"url\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"url\"\n ** module id = 9\n ** module chunks = 0\n **/","import Route from '../../shared/route';\nimport VoteService from './vote.service';\n\nclass VoteListRoute extends Route {\n\n    constructor(method = 'GET', path = '/api/votes') {\n        super({ method, path });\n        this.config = {\n            cors: true,\n            auth: 'token'\n        };\n    }\n\n    handler(request, reply) {\n        const voteService = new VoteService();\n\n        voteService.listVotes().then((votes) => {\n            const total = votes.reduce((acc, v) => acc + v.count, 0);\n\n            reply({ votes, total });\n        });\n    }\n}\n\nexport default VoteListRoute;\n\n\n/** WEBPACK FOOTER **\n ** ./src/routes/vote/vote.list.js\n **/","import Route from '../../shared/route';\nimport VoteService from './vote.service';\n\nclass VotePostRoute extends Route {\n\n    constructor(method = 'POST', path = '/api/vote') {\n        super({ method, path });\n        this.config = {\n            cors: true,\n            auth: 'token'\n        };\n    }\n\n    handler(request, reply) {\n        const voteService = new VoteService();\n        const credentials = request.auth.credentials;\n        const selectedVote = Object.assign({}, JSON.parse(request.payload).vote, {\n            date: new Date()\n        });\n        voteService.saveVote(credentials, selectedVote).then((vote) => reply({ vote }));\n    }\n}\n\nexport default VotePostRoute;\n\n\n/** WEBPACK FOOTER **\n ** ./src/routes/vote/vote.post.js\n **/","import Route from '../../shared/route';\nimport AuthService from './auth.service';\n\nclass AuthPostRoute extends Route {\n\n    constructor(method = 'POST', path = '/auth/twitter') {\n        super({ method, path });\n        this.config = {\n            cors: true\n        };\n    }\n\n    handler(request, reply) {\n        const authService = new AuthService(request.payload);\n        authService.authenticate().then((data) => {\n            reply(data);\n        });\n    }\n}\n\nexport default AuthPostRoute;\n\n\n/** WEBPACK FOOTER **\n ** ./src/routes/auth/auth.post.js\n **/","import q from 'q';\nimport qs from 'qs';\nimport jwt from 'jwt-simple';\nimport moment from 'moment';\nimport request from 'request';\nimport { CONFIG } from '../../config';\nimport { getHash, saveHash } from '../../shared/redis-db';\n\nclass AuthService {\n\n    constructor(payload = null) {\n        this.payload = JSON.parse(payload);\n\n        this.authStrategy = {\n            key: CONFIG.TOKEN_SECRET,\n            validateFunc: this.validateUser.bind(this),\n            verifyOptions: { algorithms: ['HS256'] }\n        };\n    }\n\n    authenticate() {\n        if (!this.payload.oauth_token || !this.payload.oauth_verifier) {\n            return obtainRequestToken(this.payload);\n        }\n\n        return obtainAccessToken(this.payload)\n            .then((accessToken) => obtainProfileInfo(accessToken))\n            .then((user) => createUserAccount.call(this, user))\n            .then((user) => ({\n                token: createJWT(user),\n                data: user\n            }));\n    }\n\n    validateUser(req, decoded, callback) {\n        getHash(userHashKey(decoded.sub))\n            .then((session) => {\n                if (!session) {\n                    return callback(null, false);\n                }\n                return callback(null, true, session);\n            }, () => callback(null, false));\n    }\n}\n\nfunction obtainRequestToken(payload) {\n    const deferred = q.defer();\n    const requestTokenOauth = {\n        consumer_key: CONFIG.TWITTER_KEY,\n        consumer_secret: CONFIG.TWITTER_SECRET,\n        callback: payload.redirectUri\n    };\n\n    request.post({ url: CONFIG.REQUEST_TOKEN_URL, oauth: requestTokenOauth }, (err, response, oauthToken) => {\n        if (err) {\n            deferred.reject(err);\n        }\n        // Step 2. Send OAuth token back to open the authorization screen.\n        const parsedOauthToken = qs.parse(oauthToken);\n        deferred.resolve(parsedOauthToken);\n    });\n\n    return deferred.promise;\n}\n\nfunction obtainAccessToken(payload) {\n    const deferred = q.defer();\n    const accessTokenOauth = {\n        consumer_key: CONFIG.TWITTER_KEY,\n        consumer_secret: CONFIG.TWITTER_SECRET,\n        token: payload.oauth_token,\n        verifier: payload.oauth_verifier\n    };\n\n    request.post({ url: CONFIG.ACCESS_TOKEN_URL, oauth: accessTokenOauth }, (err, response, accessToken) => {\n        if (err) {\n            deferred.reject(err);\n        }\n        const parsedAccessToken = qs.parse(accessToken);\n        deferred.resolve(parsedAccessToken);\n    });\n\n    return deferred.promise;\n}\n\nfunction obtainProfileInfo(parsedAccessToken) {\n    const deferred = q.defer();\n    const profileOauth = {\n        consumer_key: CONFIG.TWITTER_KEY,\n        consumer_secret: CONFIG.TWITTER_SECRET,\n        oauth_token: parsedAccessToken.oauth_token\n    };\n\n    // Step 4. Retrieve profile information about the current user.\n    request.get({\n        url: `${CONFIG.PROFILE_URL}${parsedAccessToken.screen_name}`,\n        oauth: profileOauth,\n        json: true\n    }, (err, response, profile) => {\n        if (err) {\n            deferred.reject(err);\n        }\n\n        const user = {\n            id: profile.id,\n            twitterHandle: profile.screen_name,\n            displayName: profile.name,\n            picture: profile.profile_image_url.replace('_normal', '')\n        };\n\n        deferred.resolve(user);\n    });\n\n    return deferred.promise;\n}\n\nfunction createUserAccount(user) {\n    return saveHash(userHashKey(user.id), user).then(() => user, (err) => err);\n}\n\nfunction createJWT(user) {\n    const payload = {\n        sub: user.id,\n        iat: moment().unix(),\n        exp: moment().add(14, 'days').unix()\n    };\n\n    return jwt.encode(payload, CONFIG.TOKEN_SECRET);\n}\n\nfunction userHashKey(id) {\n    return `user:${id}`;\n}\n\nexport default AuthService;\n\n\n/** WEBPACK FOOTER **\n ** ./src/routes/auth/auth.service.js\n **/","module.exports = require(\"qs\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"qs\"\n ** module id = 14\n ** module chunks = 0\n **/","module.exports = require(\"jwt-simple\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"jwt-simple\"\n ** module id = 15\n ** module chunks = 0\n **/","module.exports = require(\"moment\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"moment\"\n ** module id = 16\n ** module chunks = 0\n **/","module.exports = require(\"request\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"request\"\n ** module id = 17\n ** module chunks = 0\n **/","export const CONFIG = {\n    REQUEST_TOKEN_URL: 'https://api.twitter.com/oauth/request_token',\n    ACCESS_TOKEN_URL: 'https://api.twitter.com/oauth/access_token',\n    PROFILE_URL: 'https://api.twitter.com/1.1/users/show.json?screen_name=',\n\n    // App Settings\n    TOKEN_SECRET: process.env.TOKEN_SECRET || 'YOUR_UNIQUE_JWT_TOKEN_SECRET',\n\n    // OAuth 1.0\n    TWITTER_KEY: process.env.TWITTER_KEY || 'VAaXxYKOsNgE1KaFUfsFdVpBn',\n    TWITTER_SECRET: process.env.TWITTER_SECRET || 'vcjDy4ZkEzpmSpIc1iQcRH76GemJGGGPWXoSarRS7JE4JEZrvY'\n};\n\n\n/** WEBPACK FOOTER **\n ** ./src/config.js\n **/"],"sourceRoot":""}